---
title: "ScanpyInR"
author: "andy henrie"
date: "8/13/2021"
output: html_document
---

This could be a really good way to do this...  I guess we could even embed the annotation right into the tool...

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

require(reticulate)
reticulate::use_condaenv(required = TRUE, condaenv = 'sc39')

require(tidyverse)

```



```{python}

import scanpy as sc


## domenico
results_file = '/Users/ahenrie/Projects/NDCN_dev/omicser/data-raw/domenico_stem_cell/core_data.h5ad'  # the file that will store the analysis results
adata = sc.read_h5ad(results_file)

log_adata = sc.pp.log1p(adata,copy=True)
sc.tl.rank_genes_groups(log_adata, 'Condition', method='t-test_overestim_var', key_added = "t_test_corr")

diff_exp = sc.get.rank_genes_groups_df(log_adata, None, key='t_test_corr')

diff_exp.head()

```
Now lets see if we can dump to a datframe and import to R

```{python}
diff_exp = sc.get.rank_genes_groups_df(adata_update, None, key='t_test_corr')

```


## R Markdown

testing to see if this will be the best way to "ingest" data:

```{r }



```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
